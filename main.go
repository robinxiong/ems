package main

import (
	"bytes"
	"encoding/base64"
	"image/png"
	_ "image/png"
	"log"
	"net/url"
	"os"
	"strings"
)

func main() {
	imageUrl := `data%3Aimage%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAJYAAACoCAIAAACNE4BoAAAAA3NCSVQICAjb4U%2FgAAAgAElEQVR4nOy9eZBdV3Uu%2Fq219zl37r49z5oHy7IkyxPGYMBgpmAIU5jJY06cEAwOODwgDA6EFwhhcMIjEBNwwIAZAwRsDLEBGw%2FI8qTBGlqtVrdaPd6%2Bfed7zt5r%2Ff64spPA4%2Fcq9Uotd5W%2B6lKpSq2%2B5%2Byv1957Td8ibRRxBisZfLof4Az%2BX3GGwhWPMxSueJyhcMXjDIUrHmcoXPE4Q%2BGKxxkKVzzOULjicYbCFY8zFK54nKFwxeMMhSseZyhc8ThD4YrHGQpXPM5QuOJxhsIVjzMUrnicoXDF4wyFKx5nKFzxOEPhioc93Q%2FwmxACKwAGBGBVhQF5AgkAkFeBsmFhEAAnxCRetaneSTQnjWK8dJ%2FUTog6rU8ZC6WMj2qU6jYIONkbdJxPqW4b9GmQIDLgAAArt34UC0BQJSISilkNFCABLBTCDmoZAgXotC7Tf8LjjkJWAFBWEgBOmVkAFigJGMogsDqwh4eP5qReaBbvRmm%2Fm%2F%2B5rxwUIUBVIQolG3vnYJPGAWDAEGIQDDTZF%2FQ8y2TW286LTW6dhlmlDKsoVJSJvYBJAwDCAjAUTK71bEJQFiOPlw2MHpfV3OoBQ4AXMQYAKwsJKyAQA9QXXOVgtXgPTXyLS3sc0Iwxo8FiLTxaT07FthjZsguqTRtbNSpGbBi6XOg6jfQEjTXJZn9KumwzE3jL0NxG7n9p2PtMZIcT4RDUe4qNGuA3TE0AAOzhDczyL8rvwuORQiFRWFKweCVRClhESYklrs274kPNqZuCE98UwVyTj9ZT95Vz%2B4v5%2B8rpibpdaobaDMCkpDBy%2BeD8kG3cNDFUVzaORQhh1Bb4oXR9S65ybkflvGx9TaY0HKixGndeykMvznQ9GZlNxF5VCQFIlIQUrNzaP4XQ2m8fJ3j8UajiOTSIRQ3IscITQ4jiQmPhrub4l1Nzt9SUDpaTP5nvumMuv6eaOVEP4QnsEFiIbMhFm3PVpI0giXdtOjyQit6%2Fd5NjiRwdqSceWszFwhwbIQ%2BgK9E8N1Pb2VX%2Bve7CtvZye0i19Dk0%2FPLU4AuD9DAAiIKpde9T9USkTKra2lQfD3j8UUheYEgUEIIBGHCV2X%2BLxm5ML%2Fy4IXz7fO470x2%2Fnu99pBZAmUg0QGtjC1leN1LYnlu8a7Gt4c3qTOOP1k0ble9Ode9aasuSrss1QM1%2FOjo8VkqzVXHKnsUzCKuSte35youH5p83ON9ltZx7ZnLkpcHgFcxJIqPqiYxSoIhZ4eHM4%2BYa8bijUGAZrvVb70nQWKgc%2BgSO3ZCQ6p3F5JfHV9061TEjoUIRELEnUiGAwMLJUC9sL%2BWN70nF%2BdCH5PfWEoUovKxzqSFmKTZT9WTk7f66na6mIlJ4YhUAokDTgqTT6BO6Ft64ZuaZPYtg4%2FpekNv4XptdCw4hkVLAABRC4JNH4%2BnH445CAFARhqq60iOlPe9PFH820wj%2B4ejAtyb6jjdSYAeyIAAKVlghsqq6Nld71fBMU2xHGA%2Bk%2FXyTSlGw6ML%2BZLOu2h%2B67fnKvnLmwWJ2IClHKvbGY93OExQEgucuG79h5Pgt090Pzrd3JevPHVp85%2FrJTW21amJzevP7Uv2%2FRxQADgAUwnxmI4UQVD1TqKogx2pP3jkhnqxx9drRf66OfiLj5342037N%2Fg0HSkllAiiZkIvzpUs6l0Lgx4udvy7nAAhpYHyHBXv92PmHjZVP7l%2FtQBsz1b%2FZceSVv9p2rJj50lMfmG%2Bmrrp7gwml6XjJk5JCDJwjl3jjmomndi%2B9%2FYGNC00DAM4Mpyrv3jL5%2BpGZukkFI2%2FObvwLtjkHz6SPeqUCWCEBwCpCjEedouXE6dvQlQ0EXsgI1E`

	imageStr, err := url.PathUnescape(imageUrl)
	log.Println("a: ", imageStr)
	imageStr = `data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAIAAABt+uBvAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA4RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTExIDc5LjE1ODMyNSwgMjAxNS8wOS8xMC0wMToxMDoyMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDphYjllOGEzZS1iNDcwLWU1NGYtYTU2MC02NjFkNTk1YjVlY2IiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RkQ2MDY0RkVCQTAzMTFFNkIzRDdDRDQxQThGQzVFMzUiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RkQ2MDY0RkRCQTAzMTFFNkIzRDdDRDQxQThGQzVFMzUiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6ZGUyZDM3YzItMTJjYy0zOTRhLWE0ZTQtNzFiYmEyOTE2NmFhIiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6MzRhYmE5ZjQtMzA3NS0xMWU2LWFiNWEt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`
	log.Println("b: ", imageStr)
	if err != nil {
		log.Println(err)
	}

	//log.Println(imageStr)
	splits := strings.Split(imageStr, "base64,")
	//image2 := strings.TrimSpace(splits[1])

	//log.Println(imageStr)

	unbased, err := base64.StdEncoding.DecodeString(splits[1])

	if err != nil {
		panic("Cannot decode base64")
	}

	r := bytes.NewReader(unbased)

	im, err := png.Decode(r)
	if err != nil {
		panic("Bad png")
	}

	f, err := os.OpenFile("example.png", os.O_WRONLY|os.O_CREATE, 0777)
	if err != nil {
		panic("Cannot open file")
	}

	png.Encode(f, im)
}
